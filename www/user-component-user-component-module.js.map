{"version":3,"sources":["./src/app/user-component/user-component.page.html","./src/app/user-component/user-component-routing.module.ts","./src/app/user-component/user-component.module.ts","./src/app/user-component/user-component.page.scss","./src/app/user-component/user-component.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,61BAA8xB,wEAAwE,oBAAoB,2hBAA2hB,yBAAyB,uEAAuE,2QAA2Q,0CAA0C,ktBAAktB,gKAAgK,sWAAsW,0CAA0C,6EAA6E,gBAAgB,6EAA6E,aAAa,6EAA6E,yBAAyB,kaAAka,yBAAyB,8K;;;;;;;;;;;;;;;;;;;ACA1uH;AACc;AAEG;AAE1D,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,sEAAiB;KAC7B;IACD;QACE,IAAI,EAAE,KAAK;QACX,SAAS,EAAE,sEAAiB;KAC7B;CACF,CAAC;AAMF;IAAA;IAA6C,CAAC;IAAjC,8BAA8B;QAJ1C,8DAAQ,CAAC;YACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;YACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;SACxB,CAAC;OACW,8BAA8B,CAAG;IAAD,qCAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;ACpBF;AACM;AACF;AAEA;AAEoC;AAEvB;AAW1D;IAAA;IAAsC,CAAC;IAA1B,uBAAuB;QATnC,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,6FAA8B;aAC/B;YACD,YAAY,EAAE,CAAC,sEAAiB,CAAC;SAClC,CAAC;OACW,uBAAuB,CAAG;IAAD,8BAAC;CAAA;AAAH;;;;;;;;;;;;;ACnBpC;AAAe,6EAAc,yBAAyB,yBAAyB,iBAAiB,kBAAkB,sBAAsB,GAAG,gBAAgB,qBAAqB,wBAAwB,GAAG,oCAAoC,kBAAkB,GAAG,wBAAwB,qBAAqB,GAAG,oBAAoB,uBAAuB,cAAc,eAAe,oBAAoB,+BAA+B,GAAG,kBAAkB,yBAAyB,yBAAyB,gBAAgB,iBAAiB,uBAAuB,GAAG,6CAA6C,umE;;;;;;;;;;;;;;;;;;;;;;;;ACA5iB;AACH;AACE;AACiB;AACjB;AACR;AAC2B;AAE1C;AACyB;AAOnD;IAEE,2BAAoB,KAAqB,EAAU,OAAsB,EAAU,SAA0B,EAAU,KAAsB,EAAU,cAA8B,EAAS,iBAAoC;QAA9M,UAAK,GAAL,KAAK,CAAgB;QAAU,YAAO,GAAP,OAAO,CAAe;QAAU,cAAS,GAAT,SAAS,CAAiB;QAAU,UAAK,GAAL,KAAK,CAAiB;QAAU,mBAAc,GAAd,cAAc,CAAgB;QAAS,sBAAiB,GAAjB,iBAAiB,CAAmB;QAGlO,SAAI,GAAQ;YACV,EAAE,EAAE,UAAU;YACd,IAAI,EAAE,EAAE;YACR,GAAG,EAAE,EAAE;SACR,CAAC;QACF,gBAAW,GAAe,EAAE,CAAC;QAC7B,gBAAW,GAAG,KAAK;QACnB,cAAS,GAAG,KAAK;IAVqN,CAAC;IAYvO,oCAAQ,GAAR;QAAA,iBAQC;QAPC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,gBAAM;YAChC,IAAI,MAAM,CAAC,EAAE,KAAK,UAAU,EAAE;gBAC5B,KAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,cAAI;oBAChD,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBACxB,CAAC,CAAC,CAAC;aACJ;QACH,CAAC,CAAC;IACJ,CAAC;IAED,sCAAU,GAAV,UAAW,IAAI;QACb,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,KAAK,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,cAAc,KAAK,IAAI,CAAE,EAAE;YACzF,IAAI,CAAC,cAAc,EAAE;SACtB;aAAM;YACL,IAAI;gBACF,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;aACvB;YAAC,OAAO,KAAK,EAAE;aACf;SACF;QACD,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC;YAC9D,IAAI,CAAC,aAAa,EAAE;;YAEpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,mBAAmB,CAAC;IAC9C,CAAC;IAEK,0CAAc,GAApB;;;;;;wBACI,SAAI;wBAAW,qBAAM,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC;gCACjD,OAAO,EAAE,iBAAiB;6BAC3B,CAAC;;wBAFF,GAAK,OAAO,GAAG,SAEb,CAAC;wBACI,qBAAM,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;4BAAnC,sBAAO,SAA4B,EAAC;;;;KACvC;IAED,+CAAmB,GAAnB,UAAoB,EAAE;QACpB,OAAO,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,YAAY,EAAE;IACtD,CAAC;IAEK,yCAAa,GAAnB;;;;;;wBACE,IAAI,CAAC,WAAW,GAAG,EAAE;8BACa,EAAhB,SAAI,CAAC,IAAI,CAAC,MAAM;;;6BAAhB,eAAgB;wBAAzB,KAAK;wBACR,UAAU,GAAG,oDACP,EAAE;6BACT,GAAG,CAAC,KAAK,CAAC,CAAC;wBAEd,eAAI,CAAC,WAAW,EAAC,IAAI;wBAAC,qBAAM,UAAU,CAAC,cAAc,EAAE;;wBAAvD,cAAsB,SAAiC,EAAC,CAAC;;;wBALzC,IAAgB;;;;;;KAOnC;IAEK,qCAAS,GAAf;;;;;;4BACgB,qBAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;4BACpC,MAAM,EAAE,gBAAgB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI;4BACzC,OAAO,EAAE,kIAAkI;4BAC3I,OAAO,EAAE;gCACP;oCACE,IAAI,EAAE,QAAQ;oCACd,IAAI,EAAE,QAAQ;iCACf;gCACD;oCACE,IAAI,EAAE,IAAI;oCACV,OAAO,EAAE;wCACP,KAAI,CAAC,IAAI,CAAC,cAAc,GAAG,IAAI;wCAC/B,KAAI,CAAC,WAAW,EAAE;oCACpB,CAAC;iCACF;6BACF;yBACF,CAAC;;wBAhBI,KAAK,GAAG,SAgBZ;wBACF,qBAAM,KAAK,CAAC,OAAO,EAAE;;wBAArB,SAAqB,CAAC;;;;;KACvB;IAED,2CAAe,GAAf;QACE,IAAI,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI;QAC9B,IAAI,CAAC,WAAW,EAAE;IACpB,CAAC;IAED,0CAAc,GAAd;QACE,IAAI,IAAI,CAAC,WAAW;YAClB,IAAI,CAAC,WAAW,EAAE;IACtB,CAAC;IAED,uCAAW,GAAX;QACE,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE;YACd,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC;IACxC,CAAC;IAED,4CAAgB,GAAhB;QAAA,iBAUC;QATC,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC,UAAC,IAAI;YAC7C,KAAI,CAAC,SAAS,CAAC,UAAU,CAAC,KAAI,CAAC,IAAI,CAAC,IAAI,EAAE,KAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,EAAE;gBAC3F,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC;gBACf,KAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,cAAI;oBACzC,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;gBACxB,CAAC,CAAC;YACJ,CAAC,CACA,CAAC;QACJ,CAAC,CAAC;IACJ,CAAC;IAED,yCAAa,GAAb;QAAA,iBAgBC;QAfC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YAClB,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE;qBACtB,IAAI,CAAC,UAAC,IAAS;oBACd,KAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC;oBACrB,KAAI,CAAC,gBAAgB,EAAE;gBACzB,CAAC,CAAC;qBACD,KAAK,CAAC,UAAC,KAAU;oBAChB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC;oBAClB,KAAI,CAAC,gBAAgB,EAAE;gBACzB,CAAC,CAAC,CAAC;aACN;iBAAM;gBACL,IAAI,CAAC,gBAAgB,EAAE;aACxB;SACF;IACH,CAAC;IAED,uCAAW,GAAX,UAAY,KAAK;QACf,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QACnD,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;QACjC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;QACjC,IAAI,CAAC,WAAW,EAAE;IACpB,CAAC;IAED,kDAAsB,GAAtB;QACE,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QACxD,IAAI,CAAC,WAAW,GAAG,EAAE;QACrB,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACtB,IAAI,CAAC,WAAW,EAAE,CAAC;IACrB,CAAC;IAEK,2CAAe,GAArB;;;;;;4BACgB,qBAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;4BACpC,MAAM,EAAE,wBAAwB;4BAChC,OAAO,EAAE,oEAAoE;4BAC7E,OAAO,EAAE;gCACP;oCACE,IAAI,EAAE,QAAQ;oCACd,IAAI,EAAE,QAAQ;iCACf,EAAE;oCACD,IAAI,EAAE,YAAY;oCAClB,OAAO,EAAE;wCACP,KAAI,CAAC,sBAAsB,EAAE,CAAC;oCAChC,CAAC;iCACF;6BACF;yBACF,CAAC;;wBAdI,KAAK,GAAG,SAcZ;wBACF,qBAAM,KAAK,CAAC,OAAO,EAAE;;wBAArB,SAAqB,CAAC;;;;;KACvB;;gBA7J0B,8DAAc;gBAAmB,4DAAa;gBAAqB,0EAAe;gBAAiB,8DAAe;gBAA0B,iFAAc;gBAA4B,gEAAiB;;IAFvN,iBAAiB;QAL7B,+DAAS,CAAC;YACT,QAAQ,EAAE,oBAAoB;YAC9B,oOAAyC;;SAE1C,CAAC;+EAG2B,8DAAc,EAAmB,4DAAa,EAAqB,0EAAe,EAAiB,8DAAe,EAA0B,iFAAc,EAA4B,gEAAiB;OAFvN,iBAAiB,CAiK7B;IAAD,wBAAC;CAAA;AAjK6B","file":"user-component-user-component-module.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button [text]=\\\"buttonText\\\" [icon]=\\\"buttonIcon\\\" defaultHref=\\\"home\\\">\\n      </ion-back-button>\\n    </ion-buttons>\\n    <ion-title>User Edit</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card>\\n    <div style=\\\"text-align: center\\\">\\n      <img *ngIf=\\\"user.id!=='new-user' && user_photos[0]\\\" class=\\\"profile-pic\\\" [src]=\\\"user_photos[0]\\\">\\n    </div>\\n    <ion-card-header>\\n      <ion-card-title>\\n        <ion-input [(ngModel)]=\\\"user.name\\\" (ionFocus)=\\\"triedModify = True\\\" (ionBlur)=\\\"trySaveUpdates()\\\"\\n          placeholder=\\\"Insert user full name\\\"></ion-input>\\n      </ion-card-title>\\n    </ion-card-header>\\n    <ion-card-content>\\n      <div *ngIf=\\\"user.id!=='new-user'; else createUser\\\">\\n        <ion-item>\\n          <ion-label>Photos ({{user.photos.length}}/30)</ion-label>\\n          <span *ngIf=\\\"user && user.photos && user.photos.length > 0\\\">\\n            <ion-button (click)=\\\"addPhotos()\\\" side=\\\"end\\\" fill=\\\"clear\\\">\\n              <ion-icon name=\\\"add\\\"></ion-icon>\\n            </ion-button>\\n            <ion-button side=\\\"end\\\" fill=\\\"clear\\\" color=\\\"danger\\\" (click)=\\\"removeAllPhotos()\\\">\\n              <ion-icon name=\\\"trash\\\"></ion-icon>\\n            </ion-button>\\n          </span>\\n        </ion-item>\\n        <ion-card-content>\\n          <ion-button style=\\\"display: flex; justify-content: center;\\\"\\n            *ngIf=\\\"user && user.photos && user.photos.length == 0; else showPhotos\\\" (click)=\\\"addPhotos()\\\">Add photos\\n          </ion-button>\\n          <ng-template #showPhotos>\\n            <div class=\\\"container\\\">\\n              <div class=\\\"scroll\\\" scrollX=\\\"true\\\">\\n                <span *ngFor=\\\"let photo of user_photos; let i=index\\\" style=\\\"position: relative;\\\">\\n                  <img [src]=\\\"photo\\\" class=\\\"user_photo\\\">\\n                  <ion-button class=\\\"single-delete\\\" color=\\\"danger\\\" (click)=\\\"removePhoto(i)\\\">\\n                    <ion-icon name=\\\"trash\\\"></ion-icon>\\n                  </ion-button>\\n                </span>\\n              </div>\\n            </div>\\n            <div style=\\\"text-align: center\\\">\\n              <ion-button (click)=\\\"requestTraining()\\\">Request photos training</ion-button>\\n            </div>\\n          </ng-template>\\n        </ion-card-content>\\n        <ion-item>\\n          <ion-label>Search history</ion-label>\\n        </ion-item>\\n        <ion-card-content>\\n          <ion-label *ngIf=\\\"user.search_history.length === 0; else historyList\\\">No searches yet</ion-label>\\n          <ng-template #historyList style=\\\"height: 150px\\\">\\n            <ion-grid style=\\\"text-align: center;\\\" fixed=\\\"true\\\">\\n              <ion-row>\\n                <ion-col>Date</ion-col>\\n                <ion-col>Data type</ion-col>\\n                <ion-col>Number</ion-col>\\n                <ion-col>Place</ion-col>\\n              </ion-row>\\n              <ion-row *ngFor=\\\"let line of user.search_history\\\">\\n                <ion-col>\\n                  {{line.time.toDate() | date:\\\"MM/dd h:mm\\\"}}\\n                </ion-col>\\n                <ion-col>\\n                  {{line.data_type}}\\n                </ion-col>\\n                <ion-col>\\n                  {{line.number}}\\n                </ion-col>\\n                <ion-col>\\n                  {{line.place | titlecase }}\\n                </ion-col>\\n              </ion-row>\\n            </ion-grid>\\n          </ng-template>\\n        </ion-card-content>\\n      </div>\\n      <ng-template #createUser>\\n        <ion-item lines=\\\"none\\\">\\n          <ion-label>Securize account with phone ID</ion-label>\\n          <ion-checkbox [(ngModel)]=\\\"uid_verif\\\">\\n          </ion-checkbox>\\n        </ion-item>\\n        <div style=\\\"display: flex; justify-content: center;\\\">\\n          <ion-button (click)=\\\"createNewUser()\\\">Create User</ion-button>\\n        </div>\\n      </ng-template>\\n    </ion-card-content>\\n  </ion-card>\\n</ion-content>\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { UserComponentPage } from './user-component.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserComponentPage\n  },\n  {\n    path: ':id',\n    component: UserComponentPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class UserComponentPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserComponentPageRoutingModule } from './user-component-routing.module';\n\nimport { UserComponentPage } from './user-component.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    UserComponentPageRoutingModule\n  ],\n  declarations: [UserComponentPage]\n})\nexport class UserComponentPageModule {}\n","export default \".user_photo {\\n  -o-object-fit: cover;\\n     object-fit: cover;\\n  width: 100px;\\n  height: 100px;\\n  margin-right: 5px;\\n}\\n\\n.container {\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n\\n.container ::-webkit-scrollbar {\\n  display: none;\\n}\\n\\n.container .scroll {\\n  overflow: scroll;\\n}\\n\\n.single-delete {\\n  position: absolute;\\n  bottom: 0;\\n  right: 3px;\\n  font-size: 14px;\\n  --border-radius: 65% 0 0 0;\\n}\\n\\n.profile-pic {\\n  -o-object-fit: cover;\\n     object-fit: cover;\\n  width: 35vh;\\n  height: 35vh;\\n  border-radius: 50%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL21hcmMvUFJPSkVDVFMvQ2hpbmUgMjAxOS0yMDIwL0JKVFUvRW1iZWRkZWQgc3lzdGVtL0Nvcm9uYXZpcnVzLXVzZXItbWFuYWdlci1hcHAvc3JjL2FwcC91c2VyLWNvbXBvbmVudC91c2VyLWNvbXBvbmVudC5wYWdlLnNjc3MiLCJzcmMvYXBwL3VzZXItY29tcG9uZW50L3VzZXItY29tcG9uZW50LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLG9CQUFBO0tBQUEsaUJBQUE7RUFDQSxZQUFBO0VBQ0EsYUFBQTtFQUNBLGlCQUFBO0FDQ0o7O0FERUE7RUFDSSxnQkFBQTtFQUNBLG1CQUFBO0FDQ0o7O0FEQUk7RUFDRSxhQUFBO0FDRU47O0FEQUk7RUFDRSxnQkFBQTtBQ0VOOztBREVFO0VBQ0ksa0JBQUE7RUFDQSxTQUFBO0VBQ0EsVUFBQTtFQUNBLGVBQUE7RUFDQSwwQkFBQTtBQ0NOOztBREVFO0VBQ0Usb0JBQUE7S0FBQSxpQkFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0Esa0JBQUE7QUNDSiIsImZpbGUiOiJzcmMvYXBwL3VzZXItY29tcG9uZW50L3VzZXItY29tcG9uZW50LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi51c2VyX3Bob3RvIHtcbiAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICB3aWR0aDogMTAwcHg7XG4gICAgaGVpZ2h0OiAxMDBweDtcbiAgICBtYXJnaW4tcmlnaHQ6IDVweFxufVxuXG4uY29udGFpbmVyIHtcbiAgICBvdmVyZmxvdzogaGlkZGVuOyBcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgIDo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG4gICAgLnNjcm9sbCB7XG4gICAgICBvdmVyZmxvdzogc2Nyb2xsO1xuICAgIH1cbiAgfVxuXG4gIC5zaW5nbGUtZGVsZXRle1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm90dG9tOiAwO1xuICAgICAgcmlnaHQ6IDNweDtcbiAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgIC0tYm9yZGVyLXJhZGl1czogNjUlIDAgMCAwO1xuICB9XG5cbiAgLnByb2ZpbGUtcGljIHtcbiAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICB3aWR0aDogMzV2aDtcbiAgICBoZWlnaHQ6IDM1dmg7XG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICB9IiwiLnVzZXJfcGhvdG8ge1xuICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgd2lkdGg6IDEwMHB4O1xuICBoZWlnaHQ6IDEwMHB4O1xuICBtYXJnaW4tcmlnaHQ6IDVweDtcbn1cblxuLmNvbnRhaW5lciB7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG4uY29udGFpbmVyIDo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICBkaXNwbGF5OiBub25lO1xufVxuLmNvbnRhaW5lciAuc2Nyb2xsIHtcbiAgb3ZlcmZsb3c6IHNjcm9sbDtcbn1cblxuLnNpbmdsZS1kZWxldGUge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgcmlnaHQ6IDNweDtcbiAgZm9udC1zaXplOiAxNHB4O1xuICAtLWJvcmRlci1yYWRpdXM6IDY1JSAwIDAgMDtcbn1cblxuLnByb2ZpbGUtcGljIHtcbiAgb2JqZWN0LWZpdDogY292ZXI7XG4gIHdpZHRoOiAzNXZoO1xuICBoZWlnaHQ6IDM1dmg7XG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcbn0iXX0= */\"","import { Component, OnInit } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { ActivatedRoute } from '@angular/router';\nimport { FirebaseService } from '../../services/firebase.service';\nimport { AlertController } from '@ionic/angular';\nimport * as firebase from 'firebase/app';\nimport { UniqueDeviceID } from '@ionic-native/unique-device-id/ngx';\nimport { User } from \"../../models/user.interface\";\nimport 'firebase/storage';\nimport { LoadingController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-user-component',\n  templateUrl: './user-component.page.html',\n  styleUrls: ['./user-component.page.scss'],\n})\nexport class UserComponentPage implements OnInit {\n\n  constructor(private route: ActivatedRoute, private navCtrl: NavController, private fireStore: FirebaseService, private alert: AlertController, private uniqueDeviceID: UniqueDeviceID, public loadingController: LoadingController) { }\n\n  loading: any;\n  user: any = {\n    id: \"new-user\",\n    name: \"\",\n    uid: \"\"\n  };\n  user_photos: Array<any> = [];\n  triedModify = false\n  uid_verif = false\n\n  ngOnInit() {\n    this.route.params.subscribe(params => {\n      if (params.id !== \"new-user\") {\n        this.getUserDataAndWatch(params.id).subscribe(data => {\n          this.setNewData(data);\n        });\n      }\n    })\n  }\n\n  setNewData(data) {\n    this.user = data;\n    if (this.user && (this.user.request_train === true || this.user.request_photos === true )) {\n      this.presentLoading()\n    } else {\n      try {\n        this.loading.dismiss()\n      } catch (error) {\n      }\n    }\n    if (this.user && this.user.photos && this.user.photos.length > 0)\n      this.getUserPhotos()\n    else\n      this.user_photos.push('./assets/user.png')\n  }\n\n  async presentLoading() {\n      this.loading = await this.loadingController.create({\n        message: 'Please wait ...',\n      });\n      return await this.loading.present();\n  }\n\n  getUserDataAndWatch(id) {\n    return this.fireStore.getUserById(id).valueChanges()\n  }\n\n  async getUserPhotos() {\n    this.user_photos = []\n    for (let photo of this.user.photos) {\n      let storageRef = firebase\n        .storage()\n        .ref(photo);\n\n      this.user_photos.push(await storageRef.getDownloadURL());\n    }\n  }\n\n  async addPhotos() {\n    const alert = await this.alert.create({\n      header: 'Add photos to ' + this.user.name,\n      message: 'Look straight at the camera from a 30cm distance.\\nVerify that you\\'re in a room with good light, then press <strong>Ok</strong>',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n        },\n        {\n          text: \"OK\",\n          handler: () => {\n            this.user.request_photos = true\n            this.saveUpdates()\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  requestTraining() {\n    this.user.request_train = true\n    this.saveUpdates()\n  }\n\n  trySaveUpdates() {\n    if (this.triedModify)\n      this.saveUpdates()\n  }\n\n  saveUpdates() {\n    if (this.user.id)\n      this.fireStore.updateUser(this.user)\n  }\n\n  finishCreateUser() {\n    this.fireStore.getUsers().get().subscribe((snap)=>{\n      this.fireStore.createUser(this.user.name, this.user.uid, (snap.size + 1).toString()).then((id) => {\n        console.log(id)\n        this.getUserDataAndWatch(id).subscribe(data => {\n          this.setNewData(data);\n        })\n      }\n      );\n    })\n  }\n\n  createNewUser() {\n    if (this.user.name) {\n      if (this.uid_verif) {\n        this.uniqueDeviceID.get()\n          .then((uuid: any) => {\n            this.user.uid = uuid;\n            this.finishCreateUser()\n          })\n          .catch((error: any) => {\n            console.log(error)\n            this.finishCreateUser()\n          });\n      } else {\n        this.finishCreateUser()\n      }\n    }\n  }\n\n  removePhoto(index) {\n    this.fireStore.deleteImage(this.user.photos[index])\n    this.user_photos.splice(index, 1)\n    this.user.photos.splice(index, 1)\n    this.saveUpdates()\n  }\n\n  confirmDeleteAllPhotos() {\n    this.fireStore.deleteAllImagesFromUser(this.user.photos)\n    this.user_photos = []\n    this.user.photos = [];\n    this.saveUpdates();\n  }\n\n  async removeAllPhotos() {\n    const alert = await this.alert.create({\n      header: 'Delete all your photos',\n      message: 'Are you sure you want to <strong>delete all your photos ?</strong>',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n        }, {\n          text: 'Delete all',\n          handler: () => {\n            this.confirmDeleteAllPhotos();\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}