{"version":3,"sources":["./src/app/user-component/user-component.page.html","./src/app/user-component/user-component-routing.module.ts","./src/app/user-component/user-component.module.ts","./src/app/user-component/user-component.page.scss","./src/app/user-component/user-component.page.ts"],"names":[],"mappings":"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","file":"user-component-user-component-module-es2015.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button [text]=\\\"buttonText\\\" [icon]=\\\"buttonIcon\\\">\\n      </ion-back-button>\\n    </ion-buttons>\\n    <ion-title>User Edit</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <ion-card>\\n    <div style=\\\"text-align: center\\\">\\n      <img *ngIf=\\\"user.id!=='new-user' && user_photos[0]\\\" class=\\\"profile-pic\\\" [src]=\\\"user_photos[0]\\\">\\n    </div>\\n    <ion-card-header>\\n      <ion-card-title>\\n        <ion-input [(ngModel)]=\\\"user.name\\\" (ionFocus)=\\\"triedModify = True\\\" (ionBlur)=\\\"trySaveUpdates()\\\"\\n          placeholder=\\\"Insert user full name\\\"></ion-input>\\n      </ion-card-title>\\n    </ion-card-header>\\n    <ion-card-content>\\n      <div *ngIf=\\\"user.id!=='new-user'; else createUser\\\">\\n        <ion-item>\\n          <ion-label>Photos</ion-label>\\n          <span *ngIf=\\\"user && user.photos && user.photos.length > 0\\\">\\n            <ion-button (click)=\\\"addPhotos()\\\" side=\\\"end\\\" fill=\\\"clear\\\">\\n              <ion-icon name=\\\"add\\\"></ion-icon>\\n            </ion-button>\\n            <ion-button side=\\\"end\\\" fill=\\\"clear\\\" color=\\\"danger\\\" (click)=\\\"removeAllPhotos()\\\">\\n              <ion-icon name=\\\"trash\\\"></ion-icon>\\n            </ion-button>\\n          </span>\\n        </ion-item>\\n        <ion-card-content>\\n          <ion-button style=\\\"display: flex; justify-content: center;\\\"\\n            *ngIf=\\\"user && user.photos && user.photos.length == 0; else showPhotos\\\" (click)=\\\"addPhotos()\\\">Add photos\\n          </ion-button>\\n          <ng-template #showPhotos>\\n            <div class=\\\"container\\\">\\n              <div class=\\\"scroll\\\" scrollX=\\\"true\\\">\\n                <span *ngFor=\\\"let photo of user_photos; let i=index\\\" style=\\\"position: relative;\\\">\\n                  <img [src]=\\\"photo\\\" class=\\\"user_photo\\\">\\n                  <ion-button class=\\\"single-delete\\\" color=\\\"danger\\\" (click)=\\\"removePhoto(photo, i)\\\">\\n                    <ion-icon name=\\\"trash\\\"></ion-icon>\\n                  </ion-button>\\n                </span>\\n              </div>\\n            </div>\\n          </ng-template>\\n        </ion-card-content>\\n        <ion-item>\\n          <ion-label>Search history</ion-label>\\n        </ion-item>\\n        <ion-card-content>\\n          <ion-label *ngIf=\\\"!user.search_history\\\">No searches yet</ion-label>\\n        </ion-card-content>\\n      </div>\\n      <ng-template #createUser>\\n        <!-- <ion-labe></ion-labe>\\n        <ion-checkbox>\\n        </ion-checkbox> -->\\n        <div style=\\\"display: flex; justify-content: center;\\\">\\n          <ion-button (click)=\\\"createNewUser()\\\">Create User</ion-button>\\n        </div>\\n      </ng-template>\\n    </ion-card-content>\\n  </ion-card>\\n</ion-content>\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { UserComponentPage } from './user-component.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: UserComponentPage\n  },\n  {\n    path: ':id',\n    component: UserComponentPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class UserComponentPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { UserComponentPageRoutingModule } from './user-component-routing.module';\n\nimport { UserComponentPage } from './user-component.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    UserComponentPageRoutingModule\n  ],\n  declarations: [UserComponentPage]\n})\nexport class UserComponentPageModule {}\n","export default \".user_photo {\\n  -o-object-fit: cover;\\n     object-fit: cover;\\n  width: 100px;\\n  height: 100px;\\n  margin-right: 5px;\\n}\\n\\n.container {\\n  overflow: hidden;\\n  white-space: nowrap;\\n}\\n\\n.container ::-webkit-scrollbar {\\n  display: none;\\n}\\n\\n.container .scroll {\\n  overflow: scroll;\\n}\\n\\n.single-delete {\\n  position: absolute;\\n  bottom: 0;\\n  right: 3px;\\n  font-size: 14px;\\n  --border-radius: 65% 0 0 0;\\n}\\n\\n.profile-pic {\\n  -o-object-fit: cover;\\n     object-fit: cover;\\n  width: 35vh;\\n  height: 35vh;\\n  border-radius: 50%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL21hcmMvUFJPSkVDVFMvQ2hpbmUgMjAxOS0yMDIwL0JKVFUvRW1iZWRkZWQgc3lzdGVtL0Nvcm9uYXZpcnVzLXVzZXItbWFuYWdlci1hcHAvc3JjL2FwcC91c2VyLWNvbXBvbmVudC91c2VyLWNvbXBvbmVudC5wYWdlLnNjc3MiLCJzcmMvYXBwL3VzZXItY29tcG9uZW50L3VzZXItY29tcG9uZW50LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLG9CQUFBO0tBQUEsaUJBQUE7RUFDQSxZQUFBO0VBQ0EsYUFBQTtFQUNBLGlCQUFBO0FDQ0o7O0FERUE7RUFDSSxnQkFBQTtFQUNBLG1CQUFBO0FDQ0o7O0FEQUk7RUFDRSxhQUFBO0FDRU47O0FEQUk7RUFDRSxnQkFBQTtBQ0VOOztBREVFO0VBQ0ksa0JBQUE7RUFDQSxTQUFBO0VBQ0EsVUFBQTtFQUNBLGVBQUE7RUFDQSwwQkFBQTtBQ0NOOztBREVFO0VBQ0Usb0JBQUE7S0FBQSxpQkFBQTtFQUNBLFdBQUE7RUFDQSxZQUFBO0VBQ0Esa0JBQUE7QUNDSiIsImZpbGUiOiJzcmMvYXBwL3VzZXItY29tcG9uZW50L3VzZXItY29tcG9uZW50LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi51c2VyX3Bob3RvIHtcbiAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICB3aWR0aDogMTAwcHg7XG4gICAgaGVpZ2h0OiAxMDBweDtcbiAgICBtYXJnaW4tcmlnaHQ6IDVweFxufVxuXG4uY29udGFpbmVyIHtcbiAgICBvdmVyZmxvdzogaGlkZGVuOyBcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICAgIDo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICAgICAgZGlzcGxheTogbm9uZTtcbiAgICB9XG4gICAgLnNjcm9sbCB7XG4gICAgICBvdmVyZmxvdzogc2Nyb2xsO1xuICAgIH1cbiAgfVxuXG4gIC5zaW5nbGUtZGVsZXRle1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm90dG9tOiAwO1xuICAgICAgcmlnaHQ6IDNweDtcbiAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgIC0tYm9yZGVyLXJhZGl1czogNjUlIDAgMCAwO1xuICB9XG5cbiAgLnByb2ZpbGUtcGljIHtcbiAgICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgICB3aWR0aDogMzV2aDtcbiAgICBoZWlnaHQ6IDM1dmg7XG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICB9IiwiLnVzZXJfcGhvdG8ge1xuICBvYmplY3QtZml0OiBjb3ZlcjtcbiAgd2lkdGg6IDEwMHB4O1xuICBoZWlnaHQ6IDEwMHB4O1xuICBtYXJnaW4tcmlnaHQ6IDVweDtcbn1cblxuLmNvbnRhaW5lciB7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG4uY29udGFpbmVyIDo6LXdlYmtpdC1zY3JvbGxiYXIge1xuICBkaXNwbGF5OiBub25lO1xufVxuLmNvbnRhaW5lciAuc2Nyb2xsIHtcbiAgb3ZlcmZsb3c6IHNjcm9sbDtcbn1cblxuLnNpbmdsZS1kZWxldGUge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgcmlnaHQ6IDNweDtcbiAgZm9udC1zaXplOiAxNHB4O1xuICAtLWJvcmRlci1yYWRpdXM6IDY1JSAwIDAgMDtcbn1cblxuLnByb2ZpbGUtcGljIHtcbiAgb2JqZWN0LWZpdDogY292ZXI7XG4gIHdpZHRoOiAzNXZoO1xuICBoZWlnaHQ6IDM1dmg7XG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcbn0iXX0= */\"","import { Component, OnInit } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { ActivatedRoute } from '@angular/router';\nimport { FirebaseService } from '../../services/firebase.service';\nimport { AlertController } from '@ionic/angular';\nimport * as firebase from 'firebase/app';\nimport { UniqueDeviceID } from '@ionic-native/unique-device-id/ngx';\nimport { User } from \"../../models/user.interface\";\nimport 'firebase/storage';\n\n@Component({\n  selector: 'app-user-component',\n  templateUrl: './user-component.page.html',\n  styleUrls: ['./user-component.page.scss'],\n})\nexport class UserComponentPage implements OnInit {\n\n  constructor(private route: ActivatedRoute, private navCtrl: NavController, private fireStore: FirebaseService, private alert: AlertController, private uniqueDeviceID: UniqueDeviceID) { }\n\n  user: any = {\n    id: \"new-user\",\n    name: \"\"\n  };\n  user_photos: Array<any> = [];\n  triedModify = false\n\n  ngOnInit() {\n    this.route.params.subscribe(params => {\n      console.log(params)\n      if (params.id !== \"new-user\") {\n        this.getUserDataAndWatch(params.id).subscribe(data => {\n          this.user = data;\n          if (this.user.photos.length > 0)\n            this.getUserPhotos()\n          else\n            this.user_photos.push('./assets/user.png')\n        });\n      }\n    })\n  }\n\n  getUserDataAndWatch(id) {\n    return this.fireStore.getUserById(id).valueChanges()\n  }\n\n  async getUserPhotos() {\n    this.user_photos = []\n    for (let photo of this.user.photos) {\n      let storageRef = firebase\n        .storage()\n        .ref(photo);\n\n      this.user_photos.push(await storageRef.getDownloadURL());\n    }\n  }\n\n  async addPhotos() {\n    const alert = await this.alert.create({\n      header: 'Add photos to ' + this.user.name,\n      message: 'Look straight at the camera from a 30cm distance.\\nVerify that you\\'re in a room with good light, then press <strong>Ok</strong>',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n        },\n        {\n          text: \"OK\",\n          handler: () => {\n            this.user.request_photos = true\n            this.saveUpdates()\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  trySaveUpdates() {\n    if (this.triedModify)\n      this.saveUpdates()\n  }\n\n  saveUpdates() {\n    if (this.user.id)\n      this.fireStore.updateUser(this.user)\n  }\n\n  createNewUser() {\n    if (this.user.name) {\n      this.uniqueDeviceID.get()\n        .then((uuid: any) => console.log(uuid))\n        .catch((error: any) => console.log(error));\n      // this.fireStore.createUser(this.user.name).then((id) => {\n      //   this.getUserDataAndWatch(id).subscribe(data => {\n      //     this.user = data;\n      //   })\n      // }\n      // );\n    }\n  }\n\n  removePhoto(photo, index) {\n    this.fireStore.deleteImage(this.user.photos[index]);\n    this.user_photos.splice(index, 1)\n    this.user.photos.splice(index, 1)\n    this.saveUpdates()\n  }\n\n  confirmDeleteAllPhotos() {\n    this.fireStore.deleteAllImagesFromUser(this.user.photos)\n    this.user_photos = []\n    this.user.photos = [];\n    this.saveUpdates();\n  }\n\n  async removeAllPhotos() {\n    const alert = await this.alert.create({\n      header: 'Delete all your photos',\n      message: 'Are you sure you want to <strong>delete all your photos ?</strong>',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n        }, {\n          text: 'Delete all',\n          handler: () => {\n            this.confirmDeleteAllPhotos();\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}